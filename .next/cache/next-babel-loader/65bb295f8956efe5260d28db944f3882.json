{"ast":null,"code":"import _extends from \"@babel/runtime-corejs2/helpers/esm/extends\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nvar __jsx = React.createElement;\nimport React, { Component, Fragment } from 'react';\nimport Head from 'next/head';\nimport API from '../../lib/api/cms';\nimport Profile from '../../components/Customer/Profile';\nimport Configuration from '../../lib/api/configuration';\n\nclass Home extends Component {\n  constructor(props) {\n    super(props);\n\n    _defineProperty(this, \"getCookie\", cookieName => {\n      console.log(cookieName);\n      var match = document.cookie.match(new RegExp('(^| )' + cookieName + '=([^;]+)'));\n      if (match) return match[2];\n    });\n\n    _defineProperty(this, \"deleteCookie\", name => {\n      document.cookie = name + '=; Path=/; Expires=Thu, 01 Jan 1970 00:00:01 GMT;';\n    });\n\n    _defineProperty(this, \"handlePageChange\", e => {\n      this.setState({\n        page: e\n      });\n      this.getOrderList(e);\n    });\n\n    _defineProperty(this, \"handleFilterChange\", e => {\n      let status = e.target.value;\n      this.setState({\n        status: status\n      });\n      API.getOrderList(this.state.page, status).then(response => {\n        this.setState({\n          orderList: response.data\n        });\n      }).catch(error => {\n        var data = error.response;\n\n        if (data.data.messages) {\n          console.log(data.data.messages);\n        }\n      });\n    });\n\n    _defineProperty(this, \"handleChangePhone\", e => {\n      this.setState({\n        phone_number: e.target.value\n      });\n    });\n\n    _defineProperty(this, \"handleChangeName\", e => {\n      this.setState({\n        name: e.target.value\n      });\n    });\n\n    _defineProperty(this, \"handleSubmitUpdateAccount\", () => {\n      let data = {\n        name: this.state.name,\n        phone_number: this.state.phone_number,\n        gender: this.state.gender ? this.state.gender : \"M\"\n      };\n      API.updateUserDetail(data).then(response => {\n        this.setState({\n          user: response.data,\n          phone_number: response.data.phone_number\n        });\n      }).catch(error => {\n        console.log(error);\n\n        if (data.messages) {\n          alert(data.messages);\n        }\n      });\n    });\n\n    _defineProperty(this, \"handleChangeBankName\", e => {\n      this.setState({\n        bank_name: e.target.value\n      });\n    });\n\n    _defineProperty(this, \"handleChangeBankAccount\", e => {\n      this.setState({\n        bank_account: e.target.value\n      });\n    });\n\n    _defineProperty(this, \"handleChangeBank\", e => {\n      this.setState({\n        bank_id: e.target.value\n      });\n    });\n\n    _defineProperty(this, \"handleSubmitUpdateBankAccount\", () => {\n      let data = {\n        name: this.state.name,\n        gender: this.state.gender ? this.state.gender : \"M\",\n        bank_account_name: this.state.bank_name,\n        bank_account_number: this.state.bank_account,\n        bank_account_id: this.state.bank_id\n      };\n      API.updateUserDetail(data).then(response => {\n        this.setState({\n          user: response.data,\n          phone_number: response.data.phone_number\n        });\n      }).catch(error => {\n        console.log(error);\n\n        if (data.messages) {\n          alert(data.messages);\n        }\n      });\n    });\n\n    _defineProperty(this, \"logout\", e => {\n      this.deleteCookie('api_token');\n      this.deleteCookie('user_id');\n      window.location.href = \"/\";\n    });\n\n    this.state = {\n      user: [],\n      orderList: [],\n      page: 0,\n      status: \"\",\n      phone_number: \"\",\n      name: \"\",\n      gender: \"\",\n      bank_name: \"\",\n      bank_account: \"\",\n      bank: \"\",\n      bank_id: \"\",\n      bankList: []\n    };\n  }\n\n  componentDidMount() {\n    console.log(this.getCookie('api_token'));\n    Configuration.setHeader('Authorization', `Bearer ${this.getCookie('api_token')}`);\n    this.getUserDetail();\n    this.getOrderList();\n    this.getBankList();\n  }\n\n  getBankList() {\n    API.getBankList().then(response => {\n      this.setState({\n        bankList: response.data.data\n      });\n    }).catch(error => {\n      console.log(error);\n    });\n  }\n\n  getUserDetail() {\n    API.getUserDetail().then(response => {\n      this.setState({\n        user: response.data,\n        phone_number: response.data.phone_number,\n        name: response.data.name,\n        gender: response.data.gender,\n        bank_name: response.data.bank_account_name,\n        bank_account: response.data.bank_account_number,\n        bank_id: response.data.bank && response.data.bank.id\n      });\n    }).catch(error => {\n      var data = error.response;\n\n      if (data.data.messages) {\n        console.log(data.data.messages);\n      }\n    });\n  }\n\n  getOrderList(page = 1) {\n    API.getOrderList(page, \"\").then(response => {\n      this.setState({\n        orderList: response.data\n      });\n    }).catch(error => {\n      var data = error.response;\n\n      if (data.data.messages) {\n        console.log(data.data.messages);\n      }\n    });\n  }\n\n  render() {\n    return __jsx(Fragment, null, __jsx(Head, null, __jsx(\"style\", null, `body {\n                            background: url(${this.state.backgroundImage}) top center no-repeat fixed;\n                            background-size: cover;\n                        }\n                        @media (max-width: 575.98px) {\n                            #root > main {\n                                padding-left: 0rem;\n                            }\n                        }`)), __jsx(Profile, _extends({\n      orderList: this.state.orderList,\n      user: this.state.user,\n      logout: this.logout,\n      handleFilterChange: this.handleFilterChange,\n      handlePageChange: this.handlePageChange,\n      handleChangePhone: this.handleChangePhone,\n      handleSubmitUpdateAccount: this.handleSubmitUpdateAccount,\n      handleChangeName: this.handleChangeName,\n      handleSubmitUpdateBankAccount: this.handleSubmitUpdateBankAccount,\n      handleChangeBankName: this.handleChangeBankName,\n      handleChangeBankAccount: this.handleChangeBankAccount,\n      handleChangeBank: this.handleChangeBank\n    }, this.state)));\n  }\n\n}\n\nexport default Home;","map":null,"metadata":{},"sourceType":"module"}