{"ast":null,"code":"import _extends from \"@babel/runtime-corejs2/helpers/esm/extends\";\nimport _classCallCheck from \"@babel/runtime-corejs2/helpers/esm/classCallCheck\";\nimport _createClass from \"@babel/runtime-corejs2/helpers/esm/createClass\";\nimport _possibleConstructorReturn from \"@babel/runtime-corejs2/helpers/esm/possibleConstructorReturn\";\nimport _getPrototypeOf from \"@babel/runtime-corejs2/helpers/esm/getPrototypeOf\";\nimport _assertThisInitialized from \"@babel/runtime-corejs2/helpers/esm/assertThisInitialized\";\nimport _inherits from \"@babel/runtime-corejs2/helpers/esm/inherits\";\nimport _defineProperty from \"@babel/runtime-corejs2/helpers/esm/defineProperty\";\nvar __jsx = React.createElement;\nimport React, { Component, Fragment } from 'react';\nimport CMS from '../../lib/api';\nimport Head from 'next/head';\nimport CategoryFilter from '../../components/Category/CategoryFilter';\nimport SearchList from '../../components/Search/SearchList';\nimport { isMobile } from 'react-device-detect';\n\nvar Category =\n/*#__PURE__*/\nfunction (_Component) {\n  _inherits(Category, _Component);\n\n  function Category(props) {\n    var _this;\n\n    _classCallCheck(this, Category);\n\n    _this = _possibleConstructorReturn(this, _getPrototypeOf(Category).call(this, props));\n\n    _defineProperty(_assertThisInitialized(_this), \"onChangeSearchOrder\", function (event) {\n      var orderBy = '';\n      var orderType = '';\n\n      if (event.currentTarget.value == 1) {\n        orderBy = 'regular_price';\n        orderType = 'ASC';\n      }\n\n      if (event.currentTarget.value == 2) {\n        orderBy = 'regular_price';\n        orderType = 'DESC';\n      }\n\n      if (event.currentTarget.value == 3) {\n        orderBy = 'discount_percent';\n        orderType = 'DESC';\n      }\n\n      _this.setState({\n        orderBy: orderBy,\n        orderType: orderType,\n        currentPage: 1\n      });\n\n      var queryCondition = {\n        'name': _this.props.searchName,\n        'cat_name': _this.props.catUrl,\n        'page': _this.state.currentPage,\n        'min_price': _this.state.minPrice,\n        'max_price': _this.state.maxPrice,\n        'order_by': orderBy,\n        'order_type': orderType\n      };\n\n      _this.getProductsByCondition(queryCondition, true);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"onChangePriceRange\", function (event) {\n      var minPrice = '';\n      var maxPrice = '';\n\n      if (event.currentTarget.value == 1) {\n        maxPrice = 500000;\n      }\n\n      if (event.currentTarget.value == 2) {\n        minPrice = 500000;\n        maxPrice = 1000000;\n      }\n\n      if (event.currentTarget.value == 3) {\n        minPrice = 1000000;\n        maxPrice = 5000000;\n      }\n\n      if (event.currentTarget.value == 4) {\n        minPrice = 5000000;\n        maxPrice = 10000000;\n      }\n\n      if (event.currentTarget.value == 5) {\n        minPrice = 10000000;\n      }\n\n      _this.setState({\n        minPrice: minPrice,\n        maxPrice: maxPrice,\n        currentPage: 1\n      });\n\n      var queryCondition = {\n        'name': _this.props.searchName,\n        'cat_name': _this.props.catUrl,\n        'page': _this.state.currentPage,\n        'min_price': minPrice,\n        'max_price': maxPrice,\n        'orderBy': _this.state.orderBy,\n        'orderType': _this.state.orderType\n      };\n\n      _this.getProductsByCondition(queryCondition, true);\n    });\n\n    _defineProperty(_assertThisInitialized(_this), \"showMore\", function (event) {\n      var currentPage = _this.state.currentPage;\n      var queryCondition = {\n        'name': _this.props.searchName,\n        'cat_name': _this.props.catUrl,\n        'page': currentPage + 1,\n        'per_page': 20,\n        'order_by': _this.state.orderBy,\n        'order_type': _this.state.orderType,\n        'min_price': _this.state.minPrice,\n        'max_price': _this.state.maxPrice\n      };\n\n      _this.getProductsByCondition(queryCondition, false);\n    });\n\n    _this.state = {\n      currentPage: 1,\n      total: 0,\n      products: _this.props.products,\n      orderBy: '',\n      orderType: '',\n      minPrice: '',\n      maxPrice: '',\n      catName: '',\n      hideShowMore: 0,\n      post: {},\n      comments: []\n    };\n    return _this;\n  }\n\n  _createClass(Category, [{\n    key: \"mobileCheck\",\n    value: function mobileCheck() {\n      return isMobile;\n    }\n  }, {\n    key: \"getParameterByName\",\n    value: function getParameterByName(name, url) {\n      if (!url) url = window.location.href;\n      name = name.replace(/[\\[\\]]/g, \"\\\\$&\");\n      var regex = new RegExp(\"[?&]\" + name + \"(=([^&#]*)|&|#|$)\"),\n          results = regex.exec(url);\n      if (!results) return null;\n      if (!results[2]) return '';\n      return decodeURIComponent(results[2].replace(/\\+/g, \" \"));\n    }\n  }, {\n    key: \"getProductsByCondition\",\n    value: function getProductsByCondition(queryCondition) {\n      var _this2 = this;\n\n      var isResetPageNumber = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : true;\n      var products = this.state.products;\n      var currentPage = this.state.currentPage;\n      CMS.getProducts(queryCondition).then(function (response) {\n        if (!isResetPageNumber) {\n          _this2.setState({\n            products: _this2.state.products.concat(response.data.data),\n            total: response.data.pagination && response.data.pagination.total,\n            currentPage: currentPage + 1\n          });\n        } else {\n          _this2.setState({\n            products: response.data.data,\n            total: response.data.pagination && response.data.pagination.total\n          });\n        }\n\n        if (response.data.pagination && response.data.pagination.current_page == response.data.pagination.total_page) {\n          _this2.setState({\n            hideShowMore: 1\n          });\n        } else {\n          _this2.setState({\n            hideShowMore: 0\n          });\n        }\n      });\n    }\n  }, {\n    key: \"getPost\",\n    value: function getPost(slug) {\n      var _this3 = this;\n\n      CMS.getPosts(slug).then(function (response) {\n        _this3.setState({\n          post: response.data[0]\n        });\n\n        CMS.getComments(response.data[0].id).then(function (response) {\n          _this3.setState({\n            comments: response.data\n          });\n        });\n      });\n    }\n  }, {\n    key: \"render\",\n    value: function render() {\n      return __jsx(Fragment, null, __jsx(Head, null, __jsx(\"link\", {\n        key: \"shortcut_icon\",\n        rel: \"shortcut icon\",\n        href: \"/assets/images/fundi-logo.png\"\n      }), __jsx(\"link\", {\n        key: \"apple-touch-icon\",\n        rel: \"apple-touch-icon\",\n        href: \"/assets/images/fundi-logo.png\"\n      }), __jsx(\"title\", null, \"Danh mục \" + this.props.catName), __jsx(\"meta\", {\n        name: \"description\",\n        content: \"Kết quả thuộc \" + this.props.catName + \": \" + \" sản phẩm giảm giá trên Fundi.vn\" + \". Khuyến mãi HOT, coupon giảm giá, bài review để mua hàng tại Lazada, Tiki, Adayroi, Lotte, FPT shop, Nguyễn Kim và các sàn TMĐT khác.\"\n      })), __jsx(CategoryFilter, _extends({}, this.props, {\n        categories: this.props.categories,\n        total: this.props.total,\n        onChangePriceRange: this.onChangePriceRange,\n        onChangeSearchOrder: this.onChangeSearchOrder\n      })), __jsx(SearchList, _extends({}, this.props, {\n        products: this.props.products,\n        mobileCheck: this.mobileCheck,\n        showMore: this.showMore,\n        hideShowMore: this.state.hideShowMore\n      })));\n    }\n  }]);\n\n  return Category;\n}(Component);\n\nexport default Category;","map":null,"metadata":{},"sourceType":"module"}